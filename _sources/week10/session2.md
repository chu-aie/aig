# 자연어처리 기법

## 토크나이제이션

### 토크나이제이션이란?

```{image} figs/image-2-1-1.jpeg
:width: 90%
:align: center
```

- **정의**: 문자열을 토큰의 리스트로 분할하는 과정.
- **첫 단계**: NLP 파이프라인에서의 첫 번째 단계로, 기계가 이해할 수 있는 언어로 번역하는 시작점.
- **단순화**: "I like to eat apples"와 같은 간단한 문장도 토크나이제이션을 통해 ["I", "like", "to", "eat", "apples"]로 분해됨.
- **모호성**: 문장의 구조가 복잡하거나 언어가 다양할수록 토크나이제이션은 더 복잡해짐.
- **중요성**: 토크나이제이션은 임베딩과 신경망을 포함한 복잡한 NLP 시스템의 기초를 형성함.

### 토크나이제이션의 복잡성

```{image} figs/image-2-1-2.jpeg
:width: 90%
:align: center
```

- **문제 1: 단어의 결합과 분리**
  - "ice cream", "website" 등과 같이 다양한 방식으로 단어가 결합되거나 분리될 수 있음.
- **문제 2: 공백이 없는 다른 언어 체계**
  - 중국어와 같이 단어 사이에 공백을 사용하지 않는 언어들이 존재.
- **문제 3: 축약과 클리틱**
  - "doesn’t", "I’m" 등과 같은 영어의 축약 형태 또는 이탈리아어의 "dirglielo"와 같은 클리틱이 존재.

### 영어에서의 다양한 단어 형태

```{image} figs/image-2-1-3.jpeg
:width: 90%
:align: center
```

- **대소문자 변화**: "cat", "Cat", "CAT" 등 다양한 형태로 표현됨.
- **약어 및 하이픈 사용**: "US-based", "US based", "U.S.-based" 등 다양한 스타일 존재.
- **지역적 철자 변이**: "labor"와 "labour", "materialize"와 "materialise"와 같은 영어의 지역별 철자 차이.
- **오탈자**: "teh"와 같이 흔한 오타가 발생할 수 있음.

### 영어 단어의 다양성

```{image} figs/image-2-1-4.jpeg
:width: 90%
:align: center
```

- **단어의 개수**: Google N-gram 코퍼스에는 1조 개의 토큰과 4천만 번 이상 나타나는 1천3백만 개의 단어 유형이 포함됨.
- **단어 지식**: 일반적으로 성인은 약 3만 개의 단어를 알고 있으며, 유창함을 위해서는 적어도 5천 개의 단어를 알아야 함.
- **단어 빈도**: 함수어는 매우 빈번하게 사용되며, 대부분의 내용어는 매우 드물게 사용됨.

### 단어 형성 과정

```{image} figs/image-2-1-5.jpeg
:width: 90%
:align: center
```

- **활용**: 단어의 형태가 변화하는 과정. 예: 동사 "to be"의 다양한 형태 ("I am", "you are", "he is" 등).
- **파생**: 같은 기본 또는 뿌리에서 새로운 단어를 만드는 과정. 예: "grace"에서 "disgrace", "disgraceful", "disgracefully"로 변화.
- **복합어 형성**: 두 개 이상의 단어를 결합하여 새로운 단어를 형성하는 과정. 예: "Ice cream", "ice cream cone".

### 형태소와 형태

```{image} figs/image-2-1-6.jpeg
:width: 90%
:align: center
```

- **어간(Stem)**: 대부분의 단어는 어간과 하나 이상의 접사로 구성됨. 예: "disgracefully"에서 "grace"는 어간.
- **접사(Affixes)**: 접두사 또는 접미사의 형태로 나타남. 예: "disgracefully"에서 "dis-", "-ful", "-ly"가 접사.
- **복수 명사**: 대부분의 명사는 단수 형태에 "-s"를 추가하여 복수 형태를 만듦. 예: "book" → "books".
- **과거 시제 동사**: 대부분의 동사는 기본형에 "-ed"를 추가하여 과거 시제 형태를 만듦. 예: "walk" → "walked".

## 한국어 토크나이제이션

### 한국어 문장 토크나이제이션

```{image} figs/image-2-2-1.jpeg
:width: 90%
:align: center
```

- **문장 분리의 정의**: 텍스트를 개별 문장으로 나누는 과정.
- **영어와의 차이점**: 영어에서는 문장 부호를 사용하여 문장을 구분하지만, 한국어에서는 다양한 문장 구조와 문장 부호 사용으로 더 복잡함.
- **예시 1**: IP 주소와 이메일 주소가 포함된 문장에서 마침표가 문장의 끝을 나타내지 않음.
- **예시 2**: "Ph.D. students"처럼 약어에서 마침표가 문장의 끝을 나타내지 않음.
- **한국어 특성**: 마침표는 문장의 끝을 나타낼 수도, 다른 의미를 가질 수도 있음.

### 한국어 품사 태깅

```{image} figs/image-2-2-2.jpeg
:width: 90%
:align: center
```

- **품사 태깅의 정의**: 문장 속 각 단어에 품사를 할당하는 과정.
- **한국어의 품사 체계**: 체언, 수식언, 관계언, 독립언, 용언 등 5언 9품사 체계를 사용.
- **용언의 중요성**: 동사와 형용사는 어간과 어미를 결합하여 단어 형성.
- **품사 분류 기준**: 기능, 의미, 형태를 기준으로 분류.
- **언어적 다양성**: 품사 태깅은 한국어의 복잡한 형태론적, 구문론적 구조를 이해하는 데 필수적임.

  **한국어의 5언 9품사**

  | 언     | 품사               |
  | ------ | ------------------ |
  | 체언   | 명사, 대명사, 수사 |
  | 수식언 | 관형사, 부사       |
  | 관계언 | 조사               |
  | 독립언 | 감탄사             |
  | 용언   | 동사, 형용사       |

### 한국어 형태소 분석

```{image} figs/image-2-2-3.jpeg
:width: 90%
:align: center
```

- **형태소 분석의 정의**: 단어를 가장 작은 의미 단위(형태소)로 분해하고 적절한 품사 태깅을 하는 과정.
- **예시 문장 분석**: "나는 그 과자를 먹었다"는 나(대명사) + 는(조사) + 그(대명사) + 과자(명사) + 먹(동사) + -었(선어말어미) + -다(어말어미) + .(문장부호)로 분석.
- **분석 수준**: 형태소, 구문, 의미, 담화 등 다양한 수준에서 분석 가능.
- **언어의 이해**: 형태소 분석은 한국어의 복잡한 구조를 이해하는 데 중요한 역할을 함.
- **품사 할당**: 각 형태소에 적절한 품사를 할당하는 것이 중요함.

  | 원문        | 나는 그 과자를 먹었다.                                                                                      | 너는 그를 사랑하니?                                                                         |
  | ----------- | ----------------------------------------------------------------------------------------------------------- | ------------------------------------------------------------------------------------------- |
  | 형태소 분석 | 나(대명사) + 는(조사) + 그(대명사) + 과자(명 사) + 먹-(동사)+-었(선어말어미)+- 다(어말 어 미)+ .(문장 부호) | 너(대명사) + 는(조사) + 그(대명사) + 사랑(명사) +-하(동사)+니(어말 어미) + ? (문장부호)     |
  | 구문 분석   | (S (NP 나/Noun) 는/Josa (NP 그/Noun 사 과/Noun) 를/Josa (VP 먹었다/Verb)./ Punctuation)                     | (S (NP 너/Noun) 는/Josa (NP 그/Noun) 를/ Josa (NP 사랑/Noun) (VP 하니/Verb) ?/ Punctuation) |
  | 의미 분석   | 술부: 먹다 행위자: 나 대상: 그 과자                                                                         | 술부: 사랑하다 행위자: 너 대상: 그                                                          |
  | 담화 분석   | 단순 서술                                                                                                   | 의문형                                                                                      |

### 언어적(문법적) 분류

```{image} figs/image-2-2-4.jpeg
:width: 90%
:align: center
```

- **고립어, 굴절어, 교착어**: 언어의 분류에 따라 단어의 형성 방식이 다름.
- **교착어의 특징**: 한국어는 교착어로, 어간에 접사를 붙여 단어의 최종 의미를 결정함.
- **고립어의 특징**: 중국어와 티베트어와 같은 고립어는 단어 순서에 따라 의미가 결정됨.
- **굴절어의 특징**: 라틴어와 같은 굴절어는 단어 형태의 변화로 그 문법적 기능을 나타냄.
- **언어의 다양성**: 각 언어 유형은 그 언어의 특성과 구조를 반영함.

### 한국어 형태소 분석 (품사 태깅)

```{image} figs/image-2-2-5.jpeg
:width: 90%
:align: center
```

- **형태소 분석의 목적**: 문장을 형태소 단위로 나누고, 품사 태깅을 하여 동사의 다양한 사용 현상을 복원하는 과정.
- **분석 방법의 다양성**: 분석기에 따라 형태소 분리 방법이 다를 수 있음.
- **언어 처리의 기본**: 모든 자연어 처리 과정에서 가장 기본적이고 중요한 역할을 함.
- **활용의 정의**: 어간이 어미를 취함으로써 변화하는 과정.
- **규칙 활용과 불규칙 활용**: 규칙 활용은 어간이 일정하게 유지되는 반면, 불규칙 활용은 어간이나 어미가 변화함.
